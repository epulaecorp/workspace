  map_template:
    card:  # This is where you put your element config
      type: map
      entities: 
        - '[[device_tracker]]'
      default_zoom: 17
      dark_mode: true
      hours_to_show: 24
      card_mod:
        style: 
          .: |
          
            #root {
              height: 20em;
              padding-bottom: 0 !important;
            }
            ha-icon-button {
              color: var(--primary-color);
              zoom: 140%;
              margin-left: 1em;
            }
            ha-card {
              
              border-top: 2px solid #1a1a1a;
              border-radius: 10%;
              transition: none;
              margin-bottom: -4px !important;
              height: 24em !important;
            }
          ha-map$: |
            #map {
              background-color: #191919 !important;
            }
            .leaflet-control-attribution {
              display: none;
            }
            .leaflet-bar a {
              background-color: rgba(115, 123, 124, 0.2) !important;
              color: #9da0a2 !important;
              backdrop-filter: blur(0.25em);
              zoom: 140%;
            }
            a.leaflet-control-zoom-in {
              border-bottom: 1px solid #181818 !important;
            }
            .leaflet-pane.leaflet-tile-pane {
              filter: invert(0.95) grayscale(0.95) contrast(95%);
            }

  person_sidebar:
    card:
      type: vertical-stack
      cards:
        - type: entities
          entities:
            - entity: '[[person]]'
              secondary_info: last-changed

        - type: history-graph
          entities:
            - entity: '[[person]]'
          show_names: false
          card_mod:
            style: |
              ha-card {
                border: 0;
              }

        - type: custom:mod-card
          card_mod:
            style:
              hui-horizontal-stack-card$: |
                #root {
                  justify-content: space-evenly !important;
                  padding: var(--tablet-popup-button-padding);
                }
          card:
            type: horizontal-stack
            cards:
              - type: custom:button-card
                name: Encontrar mi teléfono
                icon: mdi:volume-high
                template: icon_name
                tap_action:
                  action: call-service
                  service: '[[notify_mobile]]'
                  service_data:
                    title: "Hey"
                    message: "Aquí estoy!"
                    data:
                      command: "vibrate"
                      push:
                        sound:
                          name: findmy.wav
                          critical: 1
                          volume: 1

        - type: custom:decluttering-card
          template: map_template
          variables: 
            - device_tracker: '[[device_tracker]]'

  person_sidebar2:
    card:
      type: custom:vertical-stack-in-card
      style: |
        ha-card{
          box-shadow: none;
          background: none;     
        }
      cards:

        # Person
        - type: custom:button-card
          triggers_update: all
          show_name: false
          show_icon: false
          show_state: false
          show_label: false
          styles:
            card:
              - box-shadow: none
              - border: none !important
              - border-radius: 15px
              - padding: 0
              - height: 130px
              - background: none
            grid:
              - grid-template-areas: '"item1" "item2"'
              - grid-template-columns: 1fr
              - grid-template-rows: min-content  min-content
              - row-gap: 0px
          custom_fields:
            item1:
              card:
                type: custom:button-card
                styles:
                  card:
                    - height: 50px
                    - border-radius: 0
                    - border: none !important
                    - box-shadow: none
                    - padding: 0
                    - background: none #'rgba(115, 115, 115, 0.15)'
            item2:
              card:
                # Person
                type: custom:button-card
                entity: '[[person]]'
                show_entity_picture: true
                show_name: false
                show_icon: false
                show_state: false
                styles:
                  card:
                    - padding: 0
                    - height: 120px
                    - box-shadow: none
                    - border: none 
                    - border-radius: 3px 3px 0 0
                    - background: null
                    - background-size: cover
                    - background-position: center
                    - overflow: visible
                  img_cell:
                    - width: 80px
                    - height: 80px
                    - border-radius: 509%
                    - border: 5px solid
                    - border-color: |
                        [[[
                          if (states['[[person]]'].state == 'home' )
                            return "var(--state-icon-active-color)";
                          return "var(--state-icon-color)";
                        ]]]
                    - place-self: center
                    - position: relative
                    - top: '-29%'
                  grid:
                    - grid-template-areas: '"i"'
                  entity_picture:
                    - width: 85px
                    - filter: |
                        [[[
                          if (states['[[person]]'].state != 'home' )
                            return 'grayscale(100%)';
                          return 'null';
                        ]]]
        
        # History Grap
        - type: history-graph
          show_names: false
          entities:
            - entity: '[[person]]'
          styles:
            card:
              - border: 5px solid
        
        - type: horizontal-stack
          cards:

            # Home Distance
            - entity: '[[home_distance]]'
              show_entity_picture: true
              show_name: false
              font-size: 11px
              show_state: true
              icon: >
                [[[ 
                  if (states['[[home_distance]]'].state <= 100 )
                    return "mdi:map-marker-radius-outline"
                  return "mdi:map-marker-distance"
                ]]] 
              
              styles:
                card:
                  - height: 55px
                  - border: none !important
                  - background: none
                  - padding-top: 9px
                  - margin-bottom: 2px
                  - font-size: 11px
              state:
                - operator: '=='
                  value: 0
                  color: var(--state-icon-color)
                - operator: '!='
                  value: 0
                  color: var(--state-icon-active-color)
              type: custom:button-card

            # Battery Level
            - entity: '[[battery_level]]'
              show_entity_picture: true
              show_name: false
              show_state: true
              show_label: true
              font-size: 11px
              styles:
                card:
                  - height: 55px
                  - border: none !important
                  - background: none
                  - padding-top: 9px
                  - margin-bottom: 2px
                  - font-size: 11px
                icon:
                  - color: |
                      [[[
                        if (states['[[battery_state]]'].state == 'Charging' )
                          return "var(--state-icon-active-color)";
                        return "var(--state-icon-color)";
                      ]]]
              state:
                - operator: '>'
                  value: 90
                  icon: |
                    [[[
                      if (states['[[battery_state]]'].state == 'Charging')
                        return 'mdi:battery-charging-100';
                        return 'mdi:battery';
                    ]]]
                - operator: <
                  value: 89
                  icon: |
                    [[[
                      if (states['[[battery_state]]'].state == 'Charging')
                        return 'mdi:battery-charging-' + Math.ceil(entity.state / 10) * 10;
                      return 'mdi:battery-' + Math.ceil(entity.state / 10) * 10;
                    ]]]
              type: custom:button-card
            
            # Connection Type
            - entity: '[[connection]]'
              show_name: false
              font-size: 11px
              show_state: true
              icon: >
                [[[
                  if (states['[[connection]]'].state == 'Wi-Fi' )
                    return "mdi:wifi"
                  return "mdi:wifi-off"
                ]]]
              styles:
                card:
                  - height: 55px
                  - background: none
                  - border: none !important
                  - padding-top: 9px
                  - margin-bottom: 2px
                  - font-size: 11px
                icon: 
                  - color: |
                      [[[
                        if (states['[[connection]]'].state == 'Wi-Fi' )
                          return "var(--state-icon-active-color)";
                        return "var(--state-icon-color)";
                      ]]]
                
              type: custom:button-card

            # Steps
            - entity: '[[steps]]'
              show_name: false
              show_state: true
              show_label: false
              icon: mdi:walk
              styles:
                card:
                  - height: 55px
                  - background: none
                  - border: none !important
                  - padding-top: 9px
                  - margin-bottom: 2px
                  - font-size: 11px
                icon:
                  - color: |
                      [[[
                        if (states['[[steps]]'].state >= 10000 )
                          return "var(--state-icon-active-color)";
                        return "var(--state-icon-color)";
                      ]]]
              type: custom:button-card

        # Blanck space
        - type: custom:button-card
        
        # Map
        - type: custom:decluttering-card
          template: map_template
          variables: 
            - device_tracker: '[[device_tracker]]'